### JS
[[73. JS. Переменные и типы JS. Стандартные процедуры JS.]]

### Понятие prototype
в javascript существует понятие прототип, скрытая ссылка `[[prototype]]`объекта, она же __proto__, и свойство prototype функции. Чтобы перестать путаться в этих понятиях, разберем их по одному:
- прототипом текущего объекта называют некий другой объект, из которого текущий объект черпает недостающие методы и свойства.
- скрытая ссылка `[[prototype]]` указывает на прототип текущего объекта, и по спецификации недоступна для разработки. Но в некоторых браузерах, нарушающих спецификацию, она открыта как свойство объекта __proto__, что впрочем не дает смысла ей пользоваться на прямую. т.к. это не кроссбраузерно и не корректно.
- prototype — это свойство функции! повторяю, именно функции, которое используют для передачи значения ссылке `[[prototype]]` создаваемого объекта.


### Понятие и применение this.
This в JavaScript — это ссылка на какой-то объект.

Объект, на который ссылается this, может меняться в зависимости от контекста вызова. Чаще всего this определяется тем, кто вызывает функцию.

Примеры применения this:
- В общем случае this указывает на глобальный объект. Для браузера такой объект — это само окно браузера.
- Когда this используется внутри объекта, то ссылается на сам объект.
- В режиме конструктора this автоматически указывает на объект в текущем конструкторе, откуда его вызывают.
- Для работы с методами call() и apply() this хранит контекст вызова, который не меняется во время передачи в другую функцию.

### Как использовать контекст
Контекст выполнения (execution context) — это, если говорить упрощённо, концепция, описывающая окружение, в котором производится выполнение кода на JavaScript. Код всегда выполняется внутри некоего контекста.

Типы контекстов выполнения:
- Глобальный контекст выполнения. Это базовый, используемый по умолчанию контекст выполнения. Если некий код находится не внутри какой-нибудь функции, значит этот код принадлежит глобальному контексту. Глобальный контекст характеризуется наличием глобального объекта, которым, в случае с браузером, является объект window, и тем, что ключевое слово this указывает на этот глобальный объект. В программе может быть лишь один глобальный контекст.
- Контекст выполнения функции. Каждый раз, когда вызывается функция, для неё создаётся новый контекст. Каждая функция имеет собственный контекст выполнения. В программе может одновременно присутствовать множество контекстов выполнения функций. При создании нового контекста выполнения функции он проходит через определённую последовательность шагов, о которой мы поговорим ниже.
- Контекст выполнения функции eval. Код, выполняемый внутри функции eval, также имеет собственный контекст выполнения. Однако функцией eval пользуются очень редко, поэтому здесь мы об этом контексте выполнения говорить не будем.

### Замыкания
Замыкание — это функция, у которой есть доступ к области видимости, сформированной внешней по отношению к ней функции даже после того, как эта внешняя функция завершила работу. Это значит, что в замыкании могут храниться переменные, объявленные во внешней функции и переданные ей аргументы.
![[Pasted image 20241224231149.png]]

Здесь мы вызываем функцию person(), которая возвращает внутреннюю функцию displayName(), и сохраняем эту функцию в переменной peter. Когда мы, после этого, вызываем функцию peter() (соответствующая переменная, на самом деле, хранит ссылку на функцию displayName()), в консоль выводится имя Peter.

При этом в функции displayName() нет переменной с именем name, поэтому мы можем сделать вывод о том, что эта функция может каким-то образом получать доступ к переменной, объявленной во внешней по отношению к ней функции, person(), даже после того, как эта функция отработала. Возможно это так из-за того, что функция displayName(), на самом деле, является замыканием.
### TLS
[[31. TLS. Handshake. ClientHello. ServerHello. Random. Cipher Suites. SessionID.]]

### Протокол Диффи-Хеллмана. Пример.
Протокол Диффи-Хеллмана (DH) - важнейший элемент современных реализаций TLS.
Протокол не является шифром или алгоритмом электронной подписи.
Задача Диффи-Хеллмана, лежащая в основе классической версии протокола, прямо связана с алгебраической задачей дискретного логарифмирования в конечной группе ― на вычислительной сложности этой задачи и построена защита протокола от перехвата секретного ключа.
Клиент отправляет сообщение "ClientHello", где указываются открытые ключи DH. Сервер выбирает конкретную версию и алгоритмы и сообщает свой выбор в сообщении "ServerHello", там же отправляет свой ключ DH.

Рассмотрим классический вариант DH подробнее. Здесь группа, в которой будут проводиться операции вычисления общего секрета TLS, это всего лишь множество остатков от деления на некоторое простое число, которое называют модулем. Это обязательно достаточно большое простое число. Большое - означает, что разрядность его записи превышает 1000 бит, а современная рекомендация для классического варианта - не менее 2048 бит. В TLS 1.2 сервер передаёт это число (значение модуля) в составе сообщения ServerKeyExchange, если используется классический алгоритм DH. Модуль полностью определяет группу, поэтому каких-то дополнительных параметров передавать не нужно. На практике веб-серверы используют то или иное типовое значение модуля. В TLS 1.3 доступные параметры классического DH зафиксированы и передаются только идентификаторы, обозначающие ту или иную группу. Модуль не является секретным - он передаётся в открытом виде. Таким образом, известны группы, используемые большинством веб-серверов, поддерживающих DH (классический).

### Протоколы ECDHE. DHE.
ECDHE (Elliptic curve Diffie-Hellman Ephemeral) и DHE (Hiffie-Hellman Ephemeral) - два вида используемых протоколов DH. Первый основан на эллиптических кривых, а второй - на основе сложности взятия модуля достаточно большого простого числа.



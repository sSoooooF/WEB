ARP (Address Resolution Protocol — протокол определения адреса) - протокол в компьютерных сетях, предназначенный для определения MAC-адреса другого компьютера по известному IP-адресу.

Принцип работы ARP:  
1. Устройство, которое используется для сбора данных собирает специальный запрос, который будет рассылаться для всей подсети.

2. Все хосты подсети получив запрос должны ответить, если запрашиваемые данные совпадают с их характеристиками (MAC или IP адрес).

3. Если данные запроса совпали с данными того, кто принял запрос, то он должен ответить парой значений MAC адрес и IP адрес.

Структура ARP-пакета:
Hardware type (TYPE)

Каждый канальный протокол передачи данных имеет свой номер, который хранится в этом поле. Например, Ethernet имеет номер 0x0001.

Protocol type (PTYPE)

Код сетевого протокола. Например, для IPv4 будет записано 0x0800.

Hardware length (HLEN)

Длина физического адреса в байтах. Адреса Ethernet имеют длину 6 байт (0x06).

Protocol length (PLEN)

Длина логического адреса в байтах. IPv4 адреса имеют длину 4 байта (0x04).

Operation

Код операции отправителя: 0x0001 в случае запроса и 0x0002 в случае ответа.

Sender hardware address (SHA)

Физический адрес отправителя.

Sender protocol address (SPA)

Логический адрес отправителя.

Target hardware address (THA)

Физический адрес получателя. Не требуется при запросе.

Target protocol address (TPA)